function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("lodash"),require("superagent")):"function"==typeof define&&define.amd?define(["lodash","superagent"],t):e.Matter=t(e._,e.superagent)}(this,function(e,t){"use strict";function n(t){var n="",r={};e.isObject(t)?(e.has(t,"func")&&(n+=e.has(t,"obj")?"["+t.obj+"."+t.func+"()] ":e.has(t,"file")?"["+t.file+" > "+t.func+"()] ":"["+t.func+"()] "),e.each(e.omit(e.keys(t)),function(o,s,i){"func"!=o&&"obj"!=o&&("description"==o||"message"==o?n+=t[o]:r[o]=e.isString(t[o])?t[o]:t[o])}),n+="\n"):e.isString(t)&&(n=t);var o=[n,r];return o}function r(e){return new Promise(function(t,n){e.end(function(e,r){return e?(401==e.status&&i.warn("Unauthorized. You must be signed into make this request."),n(e)):t(r.body)})})}function o(e){return c.string&&(e=e.set("Authorization","Bearer "+c.string),i.info({message:"Set auth header",func:"addAuthHeader",file:"request"})),e}e="default"in e?e["default"]:e,t="default"in t?t["default"]:t;var s={serverUrl:"http://tessellate.elasticbeanstalk.com",tokenName:"tessellate"},i={log:function(e){var t=n(e);"local"==s.envName?console.log(e):console.log.apply(console,t)},info:function(e){var t=n(e);"local"==s.envName?console.info(e):console.info.apply(console,t)},warn:function(e){var t=n(e);"local"==s.envName?console.warn(e):console.warn.apply(console,t)},debug:function(e){var t=n(e);"local"==s.envName?console.log(e):console.log.apply(console,t)},error:function(e){var t=n(e);"local"==s.envName?console.error(e):console.error.apply(console,t)}},a={},u=Object.defineProperties({item:function(e,t){return this.setItem(e,t)},setItem:function(e,t){a[e]=t,this.localExists&&window.sessionStorage.setItem(e,t)},getItem:function(e){return a[e]?a[e]:this.localExists?window.sessionStorage.getItem(e):null},removeItem:function(e){if(a[e]&&(a[e]=null),this.localExists)try{window.sessionStorage.removeItem(e)}catch(t){i.error({description:"Error removing item from session storage",error:t,obj:"storage",func:"removeItem"})}},clear:function(){if(a={},this.localExists)try{window.sessionStorage.clear()}catch(e){i.warn("Session storage could not be cleared.",e)}}},{localExists:{get:function(){var e="test";if("undefined"==typeof window||"undefined"==typeof window.sessionStorage)return!1;try{return window.sessionStorage.setItem(e,"1"),window.sessionStorage.removeItem(e),!0}catch(t){return i.error({description:"Error saving to session storage",error:t,obj:"storage",func:"localExists"}),!1}},configurable:!0,enumerable:!0}}),c=Object.defineProperties({save:function(e){this.string=e,u.setItem(s.tokenName,e)},"delete":function(){u.removeItem(s.tokenName),i.log({description:"Token was removed.",func:"delete",obj:"token"})}},{string:{get:function(){return u.getItem(s.tokenName)},set:function(e){return i.log({description:"Token was set.",token:e,func:"string",obj:"token"}),u.setItem(s.tokenName,e)},configurable:!0,enumerable:!0},data:{get:function(){},configurable:!0,enumerable:!0}}),l={get:function(e,n){var s=t.get(e);return n&&s.query(n),s=o(s),r(s)},post:function(e,n){var s=t.post(e).send(n);return s=o(s),r(s)},put:function(e,n){var s=t.put(e).send(n);return s=o(s),r(s)},del:function(e,n){var s=t.put(e).send(n);return s=o(s),r(s)}},f=function(){function t(e,n){if(_classCallCheck(this,t),!e)throw i.error({description:"Application name requires to use Matter.",func:"constructor",obj:"Matter"}),new Error("Application name is required to use Matter");this.name=e,n&&(this.options=n)}return _createClass(t,[{key:"signup",value:function(t){return l.post(this.endpoint+"/signup",t).then(function(n){return i.log({description:"Account request successful.",signupData:t,response:n,func:"signup",obj:"Matter"}),e.has(n,"account")?n.account:(i.warn({description:"Account was not contained in signup response.",signupData:t,response:n,func:"signup",obj:"Matter"}),n)})["catch"](function(e){return i.error({description:"Error requesting signup.",signupData:t,error:e,func:"signup",obj:"Matter"}),Promise.reject(e)})}},{key:"login",value:function(t){var n=this;return t&&t.password&&t.username?l.put(this.endpoint+"/login",t).then(function(t){return e.has(t,"data")&&e.has(t.data,"status")&&409==t.data.status?(i.warn({description:"Account not found.",response:t,func:"login",obj:"Matter"}),Promise.reject(t.data)):(i.log({description:"Successful login.",response:t,func:"login",obj:"Matter"}),e.has(t,"token")&&(n.token.string=t.token),e.has(t,"account")&&n.storage.setItem("currentUser"),t.account)})["catch"](function(e){return i.error({description:"Error requesting login.",error:e,status:e.status,func:"login",obj:"Matter"}),(409==e.status||400==e.status)&&(e=e.response.text),Promise.reject(e)}):(i.error({description:"Username/Email and Password are required to login",func:"login",obj:"Matter"}),Promise.reject({message:"Username/Email and Password are required to login"}))}},{key:"logout",value:function(){var e=this;return l.put(this.endpoint+"/logout").then(function(t){return i.log({description:"Logout successful.",response:t,func:"logout",obj:"Matter"}),e.storage.removeItem("currentUser"),e.token["delete"](),t})["catch"](function(t){return i.error({description:"Error requesting log out: ",error:t,func:"logout",obj:"Matter"}),e.storage.removeItem("currentUser"),e.token["delete"](),Promise.reject(t)})}},{key:"endpoint",get:function(){var t=s.serverUrl;return e.has(this,"options")&&this.options.localServer&&(t="http://localhost:4000",i.info({description:"LocalServer option was set to true. Now server url is local server.",url:t,func:"endpoint",obj:"Matter"})),"tessellate"==this.name?window&&e.has(window,"location")&&window.location.host==t&&(t="",i.info({description:"Host is Server, serverUrl simplified!",url:t,func:"endpoint",obj:"Matter"})):(t=s.serverUrl+"/apps/"+this.name,i.info({description:"Server url set.",url:t,func:"endpoint",obj:"Matter"})),t}},{key:"currentUser",get:function(){var e=this;return this.storage.item("currentUser")?Promise.resove(this.storage.item("currentUser")):l.get(this.endpoint+"/user").then(function(t){return i.log({description:"Current User Request responded.",responseData:t.data,func:"currentUser",obj:"Matter"}),e.currentUser=t.data,t.data})["catch"](function(e){return i.error({description:"Error requesting current user.",error:e,func:"currentUser",obj:"Matter"}),Promise.reject(e)})}},{key:"storage",get:function(){return u}},{key:"token",get:function(){return c}},{key:"isLoggedIn",get:function(){return this.token.string?!0:!1}}]),t}();return f});
//# sourceMappingURL=matter.min.js.map