{"version":3,"sources":["matter.min.js","/source/matter.js"],"names":["_classCallCheck","instance","Constructor","TypeError","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","protoProps","staticProps","prototype","global","factory","exports","module","require","define","amd","Matter","requester","_","this","handleResponse","req","Promise","resolve","reject","end","err","res","status","console","warn","body","addAuthHeader","storage","getItem","config","tokenName","set","log","serverUrl","window","location","hostname","setItem","itemName","itemValue","exists","sessionStorage","removeItem","clear","get","testKey","request","endpoint","queryData","query","post","data","send","put","del","token","value","tokenStr","str","user","undefined","appName","Error","name","signupData","then","response","errRes","error","loginData","password","username","has","text","localStorage"],"mappings":"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","file":"matter.min.js","sourcesContent":[null,"(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory(require('superagent'), require('underscore')) :\n\ttypeof define === 'function' && define.amd ? define(['superagent', 'underscore'], factory) :\n\tglobal.Matter = factory(global.requester,global._);\n}(this, function (requester,_) { 'use strict';\n\n\trequester = 'default' in requester ? requester['default'] : requester;\n\t_ = 'default' in _ ? _['default'] : _;\n\n\tlet config = {\n\t\tserverUrl: 'http://tessellate.elasticbeanstalk.com',\n\t\ttokenName: 'matter'\n\t};\n\t//Set server to local server if developing\n\tif (typeof window != 'undefined' && (window.location.hostname == '' || window.location.hostname == 'localhost')) {\n\t\tconfig.serverUrl = 'http://localhost:4000';\n\t}\n\n\tlet storage = {\n\t\tget exists() {\n\t\t\tconst testKey = 'test';\n\t\t\tconsole.log('storage exists called');\n\t\t\tif (typeof window != 'undefined') {\n\t\t\t\ttry {\n\t\t\t\t\twindow.sessionStorage.setItem(testKey, '1');\n\t\t\t\t\twindow.sessionStorage.removeItem(testKey);\n\t\t\t\t\treturn true;\n\t\t\t\t} catch (err) {\n\t\t\t\t\tconsole.warn('Session storage does not exist.', err);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * @description\n\t\t * Safley sets item to session storage.\n\t\t *\n\t\t * @param {String} itemName The items name\n\t\t * @param {String} itemValue The items value\n\t\t *\n\t\t *  @private\n\t\t */\n\t\tsetItem(itemName, itemValue) {\n\t\t\t//TODO: Handle itemValue being an object instead of a string\n\t\t\tif (this.exists) {\n\t\t\t\twindow.sessionStorage.setItem(itemName, itemValue);\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * @description\n\t\t * Safley gets an item from session storage.\n\t\t *\n\t\t * @param {String} itemName The items name\n\t\t *\n\t\t * @return {String}\n\t\t *\n\t\t */\n\t\tgetItem(itemName) {\n\t\t\tif (this.exists) {\n\t\t\t\tconsole.log('item loaded from session');\n\t\t\t\treturn window.sessionStorage.getItem(itemName);\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * @description\n\t\t * Safley removes item from session storage.\n\t\t *\n\t\t * @param {String} itemName - The items name\n\t\t *\n\t\t */\n\t\tremoveItem(itemName) {\n\t\t\t//TODO: Only remove used items\n\t\t\tif (this.exists) {\n\t\t\t\ttry {\n\t\t\t\t\t//Clear session storage\n\t\t\t\t\twindow.sessionStorage.removeItem(itemName);\n\t\t\t\t} catch (err) {\n\t\t\t\t\tconsole.warn('Item could not be removed from session storage.', err);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * @description\n\t\t * Safley removes item from session storage.\n\t\t *\n\t\t * @param {String} itemName the items name\n\t\t * @param {String} itemValue the items value\n\t\t *\n\t\t *  @private\n\t\t */\n\t\tclear() {\n\t\t\t//TODO: Only remove used items\n\t\t\tif (this.exists) {\n\t\t\t\ttry {\n\t\t\t\t\t\t//Clear session storage\n\t\t\t\t\twindow.sessionStorage.clear();\n\t\t\t\t} catch (err) {\n\t\t\t\t\tconsole.warn('Session storage could not be cleared.', err);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t};\n\n\tlet request = {\n\t\tget(endpoint, queryData) {\n\t\t\tvar req = requester.get(endpoint);\n\t\t\tif (queryData) {\n\t\t\t\treq.query(queryData);\n\t\t\t}\n\t\t\treq = addAuthHeader(req);\n\t\t\treturn handleResponse(req);\n\t\t},\n\t\tpost(endpoint, data) {\n\t\t\tvar req = requester.post(endpoint).send(data);\n\t\t\treq = addAuthHeader(req);\n\t\t\treturn handleResponse(req);\n\t\t},\n\t\tput(endpoint, data) {\n\t\t\tvar req = requester.put(endpoint).send(data);\n\t\t\treq = addAuthHeader(req);\n\t\t\treturn handleResponse(req);\n\t\t},\n\t\tdel(endpoint, data) {\n\t\t\tvar req = requester.put(endpoint).send(data);\n\t\t\treq = addAuthHeader(req);\n\t\t\treturn handleResponse(req);\n\t\t}\n\n\t};\n\n\tfunction handleResponse(req) {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\treq.end((err, res) => {\n\t\t\t\tif (!err) {\n\t\t\t\t\t// console.log('Response:', res);\n\t\t\t\t\treturn resolve(res.body);\n\t\t\t\t} else {\n\t\t\t\t\tif (err.status == 401) {\n\t\t\t\t\t\tconsole.warn('Unauthorized. You must be signed into make this request.');\n\t\t\t\t\t}\n\t\t\t\t\treturn reject(err);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\tfunction addAuthHeader(req) {\n\t\tif (storage.getItem(config.tokenName)) {\n\t\t\treq = req.set('Authorization', 'Bearer ' + storage.getItem(config.tokenName));\n\t\t\tconsole.log('Set auth header');\n\t\t}\n\t\treturn req;\n\t}\n\n\tclass token {\n\t\tget str() {\n\t\t\treturn storage.getItem(config.tokenName);\n\t\t}\n\t\tstr() {\n\t\t\treturn storage.setItem(config.tokenName, tokenStr);\n\t\t}\n\t\tget data() {\n\t\t\t//TODO: Decode token\n\t\t}\n\t\tsave(tokenStr) {\n\t\t\tthis.str = tokenStr;\n\t\t\tstorage.setItem(config.tokenName, tokenStr);\n\t\t}\n\n\t\tdelete() {\n\t\t\tstorage.removeItem(config.tokenName);\n\t\t}\n\t}\n\n\tlet user;\n\tlet endpoints;\n\n\tclass Matter {\n\t\t/* Constructor\n\t\t * @param {string} appName Name of application\n\t\t */\n\t\tconstructor(appName) {\n\t\t\tif (!appName) {\n\t\t\t\tthrow new Error('Application name is required to use Matter');\n\t\t\t} else {\n\t\t\t\tthis.name = appName;\n\t\t\t}\n\t\t}\n\t\t/* Endpoint getter\n\t\t *\n\t\t */\n\t\tget endpoint() {\n\t\t\tif (this.name == 'tessellate') {\n\t\t\t\treturn config.serverUrl;\n\t\t\t\t//TODO:remove host if it is tessellate.kyper.io or tessellate.elasticbeanstalk.com\n\t\t\t} else {\n\t\t\t\treturn config.serverUrl + '/apps/' + this.name;\n\t\t\t}\n\t\t}\n\t\t/* Signup\n\t\t *\n\t\t */\n\t\tsignup(signupData) {\n\t\t\treturn request.post(this.endpoint + '/signup', signupData)\n\t\t\t.then(function(response) {\n\t\t\t  console.log(response);\n\t\t\t})\n\t\t\t['catch'](function(errRes) {\n\t\t\t  console.error('[signup()] Error signing up:', errRes);\n\t\t\t  return Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t\t/** Login\n\t\t *\n\t\t */\n\t\tlogin(loginData) {\n\t\t\tif (!loginData || !loginData.password || !loginData.username) {\n\t\t\t\tconsole.error('Username/Email and Password are required to login');\n\t\t\t}\n\t\t\treturn request.put(this.endpoint + '/login', loginData)\n\t\t\t.then(function(response) {\n\t\t\t\t//TODO: Save token locally\n\t\t\t\tconsole.log(response);\n\t\t\t\tif (_.has(response, 'data') && _.has(response.data, 'status') && response.data.status == 409) {\n\t\t\t\t\tconsole.error('[login()] Account not found: ', response);\n\t\t\t\t\treturn Promise.reject(response.data);\n\t\t\t\t} else {\n\t\t\t\t\tif (_.has(response, 'token')) {\n\t\t\t\t\t\ttoken.str = response.token;\n\t\t\t\t\t}\n\t\t\t\t\treturn response;\n\t\t\t\t}\n\t\t\t})['catch'](function(errRes) {\n\t\t\t\tif (errRes.status == 409) {\n\t\t\t\t\terrRes = errRes.response.text;\n\t\t\t\t}\n\t\t\t  return Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t\t/** Logout\n\t\t */\n\t\tlogout() {\n\t\t\treturn request.put(this.endpoint + '/logout', {\n\t\t\t}).then(function(response) {\n\t\t\t  console.log('[logout()] Logout successful: ', response);\n\t\t\t  if (typeof window != 'undefined' && typeof window.localStorage.getItem(config.tokenName) != null) {\n\t\t\t\t\twindow.localStorage.setItem(config.tokenName, null);\n\t\t\t\t}\n\t\t\t  return response.body;\n\t\t\t})['catch'](function(errRes) {\n\t\t\t  console.error('[logout()] Error logging out: ', errRes);\n\t\t\t  return Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\n\t\tgetCurrentUser() {\n\t\t\t//TODO: Check Current user variable\n\t\t\treturn request.get(this.endpoint + '/user', {\n\t\t\t}).then(function(response) {\n\t\t\t\t//TODO: Save user information locally\n\t\t\t\tconsole.log('[getCurrentUser()] Current User:', response.data);\n\t\t\t\tuser = response.data;\n\t\t\t\treturn user;\n\t\t\t})['catch'](function(errRes) {\n\t\t\t\tconsole.error('[getCurrentUser()] Error getting current user: ', errRes);\n\t\t\t  return Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\n\t\tgetAuthToken() {\n\t\t\t//TODO: Load token from storage\n\t\t\tif (typeof window == 'undefined' || typeof window.localStorage.getItem(config.tokenName) == 'undefined') {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\treturn window.localStorage.getItem(config.tokenName);\n\t\t}\n\n\t};\n\n\treturn Matter;\n\n}));"],"sourceRoot":"/source/"}