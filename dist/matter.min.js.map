{"version":3,"sources":["matter.min.js","/source/matter.js"],"names":["_classCallCheck","instance","Constructor","TypeError","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","protoProps","staticProps","prototype","global","factory","exports","module","require","define","amd","Matter","superagent","_","this","handleResponse","req","Promise","resolve","reject","end","err","res","status","console","warn","body","addAuthHeader","storage","getItem","config","tokenName","set","log","serverUrl","setItem","itemName","itemValue","exists","window","sessionStorage","removeItem","clear","get","testKey","token","value","tokenStr","string","request","endpoint","queryData","query","post","data","send","put","del","user","undefined","appName","opts","Error","name","options","signupData","then","response","errRes","error","loginData","password","username","has","text","message","localServer","location","host"],"mappings":"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","file":"matter.min.js","sourcesContent":[null,"(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory(require('superagent'), require('underscore')) :\n\ttypeof define === 'function' && define.amd ? define(['superagent', 'underscore'], factory) :\n\tglobal.Matter = factory(global.superagent,global._);\n}(this, function (superagent,_) { 'use strict';\n\n\tsuperagent = 'default' in superagent ? superagent['default'] : superagent;\n\t_ = 'default' in _ ? _['default'] : _;\n\n\tlet config = {\n\t\tserverUrl: 'http://tessellate.elasticbeanstalk.com',\n\t\ttokenName: 'matter'\n\t};\n\n\tlet storage = {\n\t\tget exists() {\n\t\t\tconst testKey = 'test';\n\t\t\tif (typeof window != 'undefined') {\n\t\t\t\ttry {\n\t\t\t\t\twindow.sessionStorage.setItem(testKey, '1');\n\t\t\t\t\twindow.sessionStorage.removeItem(testKey);\n\t\t\t\t\treturn true;\n\t\t\t\t} catch (err) {\n\t\t\t\t\tconsole.warn('Session storage does not exist.', err);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * @description\n\t\t * Safley sets item to session storage.\n\t\t *\n\t\t * @param {String} itemName The items name\n\t\t * @param {String} itemValue The items value\n\t\t *\n\t\t *  @private\n\t\t */\n\t\tsetItem(itemName, itemValue) {\n\t\t\t//TODO: Handle itemValue being an object instead of a string\n\t\t\tif (this.exists) {\n\t\t\t\twindow.sessionStorage.setItem(itemName, itemValue);\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * @description\n\t\t * Safley gets an item from session storage.\n\t\t *\n\t\t * @param {String} itemName The items name\n\t\t *\n\t\t * @return {String}\n\t\t *\n\t\t */\n\t\tgetItem(itemName) {\n\t\t\tif (this.exists) {\n\t\t\t\treturn window.sessionStorage.getItem(itemName);\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * @description\n\t\t * Safley removes item from session storage.\n\t\t *\n\t\t * @param {String} itemName - The items name\n\t\t *\n\t\t */\n\t\tremoveItem(itemName) {\n\t\t\t//TODO: Only remove used items\n\t\t\tif (this.exists) {\n\t\t\t\ttry {\n\t\t\t\t\t//Clear session storage\n\t\t\t\t\twindow.sessionStorage.removeItem(itemName);\n\t\t\t\t} catch (err) {\n\t\t\t\t\tconsole.warn('Item could not be removed from session storage.', err);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * @description\n\t\t * Safley removes item from session storage.\n\t\t *\n\t\t * @param {String} itemName the items name\n\t\t * @param {String} itemValue the items value\n\t\t *\n\t\t *  @private\n\t\t */\n\t\tclear() {\n\t\t\t//TODO: Only remove used items\n\t\t\tif (this.exists) {\n\t\t\t\ttry {\n\t\t\t\t\t\t//Clear session storage\n\t\t\t\t\twindow.sessionStorage.clear();\n\t\t\t\t} catch (err) {\n\t\t\t\t\tconsole.warn('Session storage could not be cleared.', err);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t};\n\n\tclass token {\n\t\tget string() {\n\t\t\treturn storage.getItem(config.tokenName);\n\t\t}\n\t\tget data() {\n\t\t\t//TODO: Decode token\n\t\t}\n\t\tstring(tokenStr) {\n\t\t\tconsole.log('Token was set', tokenStr);\n\t\t\treturn storage.setItem(config.tokenName, tokenStr);\n\t\t}\n\t\tsave(tokenStr) {\n\t\t\tthis.string = tokenStr;\n\t\t\tstorage.setItem(config.tokenName, tokenStr);\n\t\t}\n\t\tdelete() {\n\t\t\tstorage.removeItem(config.tokenName);\n\t\t\tconsole.log('Token was removed');\n\t\t}\n\t}\n\n\tlet request = {\n\t\tget(endpoint, queryData) {\n\t\t\tvar req = superagent.get(endpoint);\n\t\t\tif (queryData) {\n\t\t\t\treq.query(queryData);\n\t\t\t}\n\t\t\treq = addAuthHeader(req);\n\t\t\treturn handleResponse(req);\n\t\t},\n\t\tpost(endpoint, data) {\n\t\t\tvar req = superagent.post(endpoint).send(data);\n\t\t\treq = addAuthHeader(req);\n\t\t\treturn handleResponse(req);\n\t\t},\n\t\tput(endpoint, data) {\n\t\t\tvar req = superagent.put(endpoint).send(data);\n\t\t\treq = addAuthHeader(req);\n\t\t\treturn handleResponse(req);\n\t\t},\n\t\tdel(endpoint, data) {\n\t\t\tvar req = superagent.put(endpoint).send(data);\n\t\t\treq = addAuthHeader(req);\n\t\t\treturn handleResponse(req);\n\t\t}\n\n\t};\n\n\tfunction handleResponse(req) {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\treq.end((err, res) => {\n\t\t\t\tif (!err) {\n\t\t\t\t\t// console.log('Response:', res);\n\t\t\t\t\treturn resolve(res.body);\n\t\t\t\t} else {\n\t\t\t\t\tif (err.status == 401) {\n\t\t\t\t\t\tconsole.warn('Unauthorized. You must be signed into make this request.');\n\t\t\t\t\t}\n\t\t\t\t\treturn reject(err);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\tfunction addAuthHeader(req) {\n\t\tif (storage.getItem(config.tokenName)) {\n\t\t\treq = req.set('Authorization', 'Bearer ' + storage.getItem(config.tokenName));\n\t\t\tconsole.log('Set auth header');\n\t\t}\n\t\treturn req;\n\t}\n\n\tlet user;\n\tlet endpoints;\n\n\tclass Matter {\n\t\t/* Constructor\n\t\t * @param {string} appName Name of application\n\t\t */\n\t\tconstructor(appName, opts) {\n\t\t\tif (!appName) {\n\t\t\t\tthrow new Error('Application name is required to use Matter');\n\t\t\t} else {\n\t\t\t\tthis.name = appName;\n\t\t\t}\n\t\t\tif (opts) {\n\t\t\t\tthis.options = opts;\n\t\t\t}\n\t\t}\n\t\t/* Endpoint getter\n\t\t *\n\t\t */\n\t\tget endpoint() {\n\t\t\tlet serverUrl = config.serverUrl;\n\t\t\tif (_.has(this, 'options') && this.options.localServer) {\n\t\t\t\tserverUrl = 'http://localhost:4000';\n\t\t\t}\n\t\t\tif (this.name == 'tessellate') {\n\t\t\t\t//Remove url if host is server\n\t\t\t\tif (window && _.has(window, 'location') && window.location.host == serverUrl) {\n\t\t\t\t\tconsole.warn('Host is Server, serverUrl simplified!');\n\t\t\t\t\tserverUrl = '';\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tserverUrl = config.serverUrl + '/apps/' + this.name;\n\t\t\t}\n\t\t\treturn serverUrl;\n\t\t}\n\t\t/* Signup\n\t\t *\n\t\t */\n\t\tsignup(signupData) {\n\t\t\treturn request.post(this.endpoint + '/signup', signupData)\n\t\t\t.then(function(response) {\n\t\t\t  console.log(response);\n\t\t\t})\n\t\t\t['catch'](function(errRes) {\n\t\t\t  console.error('[signup()] Error signing up:', errRes);\n\t\t\t  return Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t\t/** Login\n\t\t *\n\t\t */\n\t\tlogin(loginData) {\n\t\t\tif (!loginData || !loginData.password || !loginData.username) {\n\t\t\t\tconsole.error('Username/Email and Password are required to login');\n\t\t\t  return Promise.reject({message: 'Username/Email and Password are required to login'});\n\t\t\t}\n\t\t\treturn request.put(this.endpoint + '/login', loginData)\n\t\t\t.then(function(response) {\n\t\t\t\t//TODO: Save token locally\n\t\t\t\tif (_.has(response, 'data') && _.has(response.data, 'status') && response.data.status == 409) {\n\t\t\t\t\tconsole.error('[Matter.login()] Account not found: ', response);\n\t\t\t\t\treturn Promise.reject(response.data);\n\t\t\t\t} else {\n\t\t\t\t\tif (_.has(response, 'token')) {\n\t\t\t\t\t\ttoken.string = response.token;\n\t\t\t\t\t}\n\t\t\t\t\tconsole.log('[Matter.login()] Successful login: ', response);\n\t\t\t\t\treturn response;\n\t\t\t\t}\n\t\t\t})['catch'](function(errRes) {\n\t\t\t\tif (errRes.status == 409 || errRes.status == 400) {\n\t\t\t\t\terrRes = errRes.response.text;\n\t\t\t\t}\n\t\t\t  return Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t\t/** Logout\n\t\t */\n\t\tlogout() {\n\t\t\treturn request.put(this.endpoint + '/logout').then(function(response) {\n\t\t\t  console.log('[Matter.logout()] Logout successful: ', response);\n\t\t\t  token.delete();\n\t\t\t  return response;\n\t\t\t})['catch'](function(errRes) {\n\t\t\t  console.error('[Matter.logout()] Error logging out: ', errRes);\n\t\t\t  token.delete();\n\t\t\t  return Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\n\t\tgetCurrentUser() {\n\t\t\t//TODO: Check Current user variable\n\t\t\treturn request.get(this.endpoint + '/user', {\n\t\t\t}).then(function(response) {\n\t\t\t\t//TODO: Save user information locally\n\t\t\t\tconsole.log('[getCurrentUser()] Current User:', response.data);\n\t\t\t\tuser = response.data;\n\t\t\t\treturn user;\n\t\t\t})['catch'](function(errRes) {\n\t\t\t\tconsole.error('[getCurrentUser()] Error getting current user: ', errRes);\n\t\t\t  return Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\n\t\tgetAuthToken() {\n\t\t\treturn token.string;\n\t\t}\n\t};\n\n\treturn Matter;\n\n}));"],"sourceRoot":"/source/"}