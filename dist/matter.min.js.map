{"version":3,"sources":["matter.min.js","/source/matter.js"],"names":["_classCallCheck","instance","Constructor","TypeError","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","protoProps","staticProps","prototype","global","factory","exports","module","require","define","amd","Matter","_","jwtDecode","superagent","this","runConsoleMethod","methodName","methodData","console","apply","log","buildMessageArgs","logData","msgStr","msgObj","isObject","has","obj","func","file","each","omit","keys","ind","list","isString","msg","decodeToken","tokenStr","tokenData","undefined","err","logger","error","description","data","Error","handleResponse","req","Promise","resolve","reject","end","res","status","warn","body","addAuthHeader","token","string","set","info","message","config","serverUrl","tokenName","tokenDataName","tokenUserDataName","msgArgs","envName","debug","storage","item","itemName","itemValue","setItem","localExists","JSON","stringify","window","sessionStorage","getItem","itemStr","isObj","itemObj","parse","removeItem","clear","get","testKey","save","delete","request","endpoint","queryData","query","post","send","put","del","domUtil","loadCss","src","document","css","createElement","rel","type","href","getElementsByTagName","insertBefore","firstChild","element","loadJs","js","appendChild","asyncLoadJs","setTimeout","Google","app","value","initHello","then","hello","login","loadHello","init","google","redirect_uri","on","auth","network","api","r","userData","provider","response","errRes","appName","opts","name","options","signupData","account","signup","loginData","_this","password","username","text","_this2","currentUser","_this3","resove","isLoggedIn","responseData","updateData","_this4","checkGroups","_this5","isArray","isInGroups","_ret","groupName","groupsArray","split","v","groups","group","userGroups","any","_this6","map","isInGroup","localServer","url","location","host","user"],"mappings":"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","file":"matter.min.js","sourcesContent":[null,"(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory(require('lodash'), require('jwt-decode'), require('superagent')) :\n\ttypeof define === 'function' && define.amd ? define(['lodash', 'jwt-decode', 'superagent'], factory) :\n\tglobal.Matter = factory(global._,global.jwtDecode,global.superagent);\n}(this, function (_,jwtDecode,superagent) { 'use strict';\n\n\t_ = 'default' in _ ? _['default'] : _;\n\tjwtDecode = 'default' in jwtDecode ? jwtDecode['default'] : jwtDecode;\n\tsuperagent = 'default' in superagent ? superagent['default'] : superagent;\n\n\tlet config = {\n\t\tserverUrl: 'http://tessellate.elasticbeanstalk.com',\n\t\ttokenName: 'tessellate',\n\t\ttokenDataName: 'tessellate-tokenData',\n\t\ttokenUserDataName: 'tessellate-currentUser'\n\t};\n\n\tlet logger = {\n\t\tlog(logData) {\n\t\t\tlet msgArgs = buildMessageArgs(logData);\n\t\t\tif (config.envName == 'production') {\n\t\t\t\trunConsoleMethod('log', msgArgs);\n\t\t\t} else {\n\t\t\t\trunConsoleMethod('log', msgArgs);\n\t\t\t}\n\t\t},\n\t\tinfo(logData) {\n\t\t\tlet msgArgs = buildMessageArgs(logData);\n\t\t\tif (config.envName == 'production') {\n\t\t\t\trunConsoleMethod('info', msgArgs);\n\t\t\t} else {\n\t\t\t\trunConsoleMethod('info', msgArgs);\n\t\t\t}\n\t\t},\n\t\twarn(logData) {\n\t\t\tlet msgArgs = buildMessageArgs(logData);\n\t\t\tif (config.envName == 'production') {\n\t\t\t\trunConsoleMethod('warn', msgArgs);\n\t\t\t} else {\n\t\t\t\trunConsoleMethod('warn', msgArgs);\n\t\t\t}\n\t\t},\n\t\tdebug(logData) {\n\t\t\tlet msgArgs = buildMessageArgs(logData);\n\t\t\tif (config.envName == 'production') {\n\t\t\t\t// runConsoleMethod('debug', msgArgs);\n\t\t\t\t//Do not display console debugs in production\n\t\t\t} else {\n\t\t\t\trunConsoleMethod('debug', msgArgs);\n\t\t\t}\n\t\t},\n\t\terror(logData) {\n\t\t\tlet msgArgs = buildMessageArgs(logData);\n\t\t\tif (config.envName == 'production') {\n\t\t\t\t//TODO: Log to external logger\n\t\t\t\trunConsoleMethod('error', msgArgs);\n\t\t\t} else {\n\t\t\t\trunConsoleMethod('error', msgArgs);\n\t\t\t}\n\t\t}\n\t};\n\n\tfunction runConsoleMethod(methodName, methodData) {\n\t\t//Safley run console methods or use console log\n\t\tif (methodName && console[methodName]) {\n\t\t\treturn console[methodName].apply(console, methodData);\n\t\t} else {\n\t\t\treturn console.log.apply(console, methodData);\n\t\t}\n\t}\n\tfunction buildMessageArgs(logData) {\n\t\tvar msgStr = '';\n\t\tvar msgObj = {};\n\t\t//TODO: Attach time stamp\n\t\tif (_.isObject(logData)) {\n\t\t\tif (_.has(logData, 'func')) {\n\t\t\t\tif (_.has(logData, 'obj')) {\n\t\t\t\t\tmsgStr += '[' + logData.obj + '.' + logData.func + '()] ';\n\t\t\t\t} else if (_.has(logData, 'file')) {\n\t\t\t\t\tmsgStr += '[' + logData.file + ' > ' + logData.func + '()] ';\n\t\t\t\t} else {\n\t\t\t\t\tmsgStr += '[' + logData.func + '()] ';\n\t\t\t\t}\n\t\t\t}\n\t\t\t//Print each key and its value other than obj and func\n\t\t\t_.each(_.omit(_.keys(logData)), function(key, ind, list) {\n\t\t\t\tif (key != 'func' && key != 'obj') {\n\t\t\t\t\tif (key == 'description' || key == 'message') {\n\t\t\t\t\t\tmsgStr += logData[key];\n\t\t\t\t\t} else if (_.isString(logData[key])) {\n\t\t\t\t\t\t// msgStr += key + ': ' + logData[key] + ', ';\n\t\t\t\t\t\tmsgObj[key] = logData[key];\n\t\t\t\t\t} else {\n\t\t\t\t\t\t//Print objects differently\n\t\t\t\t\t\t// msgStr += key + ': ' + logData[key] + ', ';\n\t\t\t\t\t\tmsgObj[key] = logData[key];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\tmsgStr += '\\n';\n\t\t} else if (_.isString(logData)) {\n\t\t\tmsgStr = logData;\n\t\t}\n\t\tvar msg = [msgStr, msgObj];\n\n\t\treturn msg;\n\t}\n\n\tlet data = {};\n\tlet storage = {\n\t\tget localExists() {\n\t\t\tconst testKey = 'test';\n\t\t\tif (typeof window != 'undefined' && typeof window.sessionStorage != 'undefined') {\n\t\t\t\ttry {\n\t\t\t\t\twindow.sessionStorage.setItem(testKey, '1');\n\t\t\t\t\twindow.sessionStorage.removeItem(testKey);\n\t\t\t\t\treturn true;\n\t\t\t\t} catch (err) {\n\t\t\t\t\tlogger.error({description: 'Error saving to session storage', error: err,  obj: 'storage', func: 'localExists'});\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * @description\n\t\t * Safley sets item to session storage.\n\t\t *\n\t\t * @param {String} itemName The items name\n\t\t * @param {String} itemValue The items value\n\t\t *\n\t\t */\n\t\titem(itemName, itemValue) {\n\t\t\treturn this.setItem(itemName, itemValue);\n\t\t},\n\t\t/**\n\t\t * @description\n\t\t * Safley sets item to session storage. Alias: item()\n\t\t *\n\t\t * @param {String} itemName The items name\n\t\t * @param {String} itemValue The items value\n\t\t *\n\t\t */\n\t\tsetItem(itemName, itemValue) {\n\t\t\tdata[itemName] = itemValue;\n\t\t\tif (this.localExists) {\n\t\t\t\t//Convert object to string\n\t\t\t\tif (_.isObject(itemValue)) {\n\t\t\t\t\titemValue = JSON.stringify(itemValue);\n\t\t\t\t}\n\t\t\t\twindow.sessionStorage.setItem(itemName, itemValue);\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * @description\n\t\t * Safley gets an item from session storage. Alias: item()\n\t\t *\n\t\t * @param {String} itemName The items name\n\t\t *\n\t\t * @return {String}\n\t\t *\n\t\t */\n\t\tgetItem(itemName) {\n\t\t\tif (data[itemName]) {\n\t\t\t\treturn data[itemName];\n\t\t\t} else if (this.localExists) {\n\t\t\t\tlet itemStr = window.sessionStorage.getItem(itemName);\n\t\t\t\t//Check that str is not null before parsing\n\t\t\t\tif (itemStr) {\n\t\t\t\t\tlet isObj = false;\n\t\t\t\t\tlet itemObj = null;\n\t\t\t\t\t//Try parsing to object\n\t\t\t\t\ttry {\n\t\t\t\t\t\titemObj = JSON.parse(itemStr);\n\t\t\t\t\t\tisObj = true;\n\t\t\t\t\t} catch (err) {\n\t\t\t\t\t\t// logger.log({message: 'String could not be parsed.', error: err, func: 'getItem', obj: 'storage'});\n\t\t\t\t\t\t//Parsing failed, this must just be a string\n\t\t\t\t\t\tisObj = false;\n\t\t\t\t\t}\n\t\t\t\t\tif (isObj) {\n\t\t\t\t\t\treturn itemObj;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn itemStr;\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * @description\n\t\t * Safley removes item from session storage.\n\t\t *\n\t\t * @param {String} itemName - The items name\n\t\t *\n\t\t */\n\t\tremoveItem(itemName) {\n\t\t\t//TODO: Only remove used items\n\t\t\tif (data[itemName]) {\n\t\t\t\tdata[itemName] = null;\n\t\t\t}\n\t\t\tif (this.localExists) {\n\t\t\t\ttry {\n\t\t\t\t\t//Clear session storage\n\t\t\t\t\twindow.sessionStorage.removeItem(itemName);\n\t\t\t\t} catch (err) {\n\t\t\t\t\tlogger.error({description: 'Error removing item from session storage', error: err,  obj: 'storage', func: 'removeItem'});\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * @description\n\t\t * Safley removes item from session storage.\n\t\t *\n\t\t * @param {String} itemName the items name\n\t\t * @param {String} itemValue the items value\n\t\t *\n\t\t */\n\t\tclear() {\n\t\t\t//TODO: Only remove used items\n\t\t\tdata = {};\n\t\t\tif (this.localExists) {\n\t\t\t\ttry {\n\t\t\t\t\t\t//Clear session storage\n\t\t\t\t\twindow.sessionStorage.clear();\n\t\t\t\t} catch (err) {\n\t\t\t\t\tlogger.warn('Session storage could not be cleared.', err);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t};\n\n\tfunction decodeToken(tokenStr) {\n\t\tlet tokenData;\n\t\tif (tokenStr && tokenStr != '') {\n\t\t\ttry {\n\t\t\t\ttokenData = jwtDecode(tokenStr);\n\t\t\t} catch (err) {\n\t\t\t\tlogger.error({description: 'Error decoding token.', data: tokenData, error: err, func: 'decodeToken', file: 'token'});\n\t\t\t\tthrow new Error('Invalid token string.');\n\t\t\t}\n\t\t}\n\t\treturn tokenData;\n\t}\n\tlet token = {\n\t\tget string() {\n\t\t\treturn storage.getItem(config.tokenName);\n\t\t},\n\t\tget data() {\n\t\t\tif (storage.getItem(config.tokenDataName)) {\n\t\t\t\treturn storage.getItem(config.tokenDataName);\n\t\t\t} else {\n\t\t\t\treturn decodeToken(this.string);\n\t\t\t}\n\t\t},\n\t\tset data(tokenData) {\n\t\t\tif (_.isString(tokenData)) {\n\t\t\t\tlet tokenStr = tokenData;\n\t\t\t\ttokenData = decodeToken(tokenStr);\n\t\t\t\tlogger.info({description: 'Token data was set as string. Decoding token.', token: tokenStr, tokenData: tokenData, func: 'data', obj: 'token'});\n\t\t\t} else {\n\t\t\t\tlogger.log({description: 'Token data was set.', data: tokenData, func: 'data', obj: 'token'});\n\t\t\t\tstorage.setItem(config.tokenDataName, tokenData);\n\t\t\t}\n\t\t},\n\t\tset string(tokenStr) {\n\t\t\tlogger.log({description: 'Token was set.', token: tokenStr, func: 'string', obj: 'token'});\n\t\t\tthis.data = jwtDecode(tokenStr);\n\t\t\tstorage.setItem(config.tokenName, tokenStr);\n\t\t},\n\t\tsave(tokenStr) {\n\t\t\tthis.string = tokenStr;\n\t\t},\n\t\tdelete() {\n\t\t\tstorage.removeItem(config.tokenName);\n\t\t\tstorage.removeItem(config.tokenDataName);\n\t\t\tlogger.log({description: 'Token was removed.', func: 'delete', obj: 'token'});\n\t\t}\n\t};\n\n\tlet request = {\n\t\tget(endpoint, queryData) {\n\t\t\tvar req = superagent.get(endpoint);\n\t\t\tif (queryData) {\n\t\t\t\treq.query(queryData);\n\t\t\t}\n\t\t\treq = addAuthHeader(req);\n\t\t\treturn handleResponse(req);\n\t\t},\n\t\tpost(endpoint, data) {\n\t\t\tvar req = superagent.post(endpoint).send(data);\n\t\t\treq = addAuthHeader(req);\n\t\t\treturn handleResponse(req);\n\t\t},\n\t\tput(endpoint, data) {\n\t\t\tvar req = superagent.put(endpoint).send(data);\n\t\t\treq = addAuthHeader(req);\n\t\t\treturn handleResponse(req);\n\t\t},\n\t\tdel(endpoint, data) {\n\t\t\tvar req = superagent.put(endpoint).send(data);\n\t\t\treq = addAuthHeader(req);\n\t\t\treturn handleResponse(req);\n\t\t}\n\t};\n\n\tfunction handleResponse(req) {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\treq.end((err, res) => {\n\t\t\t\tif (!err) {\n\t\t\t\t\t// logger.log({description: 'Response:', response:res, func:'handleResponse', file: 'request'});\n\t\t\t\t\treturn resolve(res.body);\n\t\t\t\t} else {\n\t\t\t\t\tif (err.status == 401) {\n\t\t\t\t\t\tconsole.warn('Unauthorized. You must be signed into make this request.');\n\t\t\t\t\t}\n\t\t\t\t\treturn reject(err);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\tfunction addAuthHeader(req) {\n\t\tif (token.string) {\n\t\t\treq = req.set('Authorization', 'Bearer ' + token.string);\n\t\t\tconsole.info({message: 'Set auth header', func: 'addAuthHeader', file: 'request'});\n\t\t}\n\t\treturn req;\n\t}\n\n\tlet domUtil = {\n\t\t/**\n\t\t * @description\n\t\t * Appends given css source to DOM head.\n\t\t *\n\t\t * @param {String} src - url src for css to append\n\t\t *\n\t\t */\n\t\tloadCss: (src) => {\n\t\t\tif (!document) {\n\t\t\t\tlogger.error({description: 'Document does not exsist to load assets into.', func: 'loadCss', obj: 'dom'});\n\t\t\t\tthrow new Error('Document object is required to load assets.');\n\t\t\t} else {\n\t\t\t\tlet css = document.createElement('link');\n\t\t\t\tcss.rel = 'stylesheet';\n\t\t\t\tcss.type = 'text/css';\n\t\t\t\tcss.href = src;\n\t\t\t\tdocument.getElementsByTagName('head')[0].insertBefore(css, document.getElementsByTagName('head')[0].firstChild);\n\t\t\t\tlogger.log({description: 'CSS was loaded into document.', element: css, func: 'loadCss', obj: 'dom'});\n\t\t\t\treturn css; //Return link element\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * @description\n\t\t * Appends given javascript source to DOM head.\n\t\t *\n\t\t * @param {String} src - url src for javascript to append\n\t\t *\n\t\t */\n\t\tloadJs: (src) => {\n\t\t\tif (window && !_.has(window, 'document')) {\n\t\t\t\tlogger.error({description: 'Document does not exsist to load assets into.', func: 'loadCss', obj: 'dom'});\n\t\t\t\tthrow new Error('Document object is required to load assets.');\n\t\t\t} else {\n\t\t\t\tlet js = window.document.createElement('script');\n\t\t\t\tjs.src = src;\n\t\t\t\tjs.type = 'text/javascript';\n\t\t\t\twindow.document.getElementsByTagName('head')[0].appendChild(js);\n\t\t\t\tlogger.log({description: 'JS was loaded into document.', element: js, func: 'loadCss', obj: 'dom'});\n\t\t\t\treturn js; //Return script element\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * @description\n\t\t * Appends given javascript source to DOM head.\n\t\t *\n\t\t * @param {String} src - url src for javascript to append\n\t\t *\n\t\t */\n\t\tasyncLoadJs: (src) => {\n\t\t\tif (!_.has(window, 'document')) {\n\t\t\t\tlogger.error({description: 'Document does not exsist to load assets into.', func: 'loadCss', obj: 'dom'});\n\t\t\t\tthrow new Error('Document object is required to load assets.');\n\t\t\t} else {\n\t\t\t\tlet js = window.document.createElement('script');\n\t\t\t\tjs.src = src;\n\t\t\t\tjs.type = 'text/javascript';\n\t\t\t\twindow.document.getElementsByTagName('head')[0].appendChild(js);\n\t\t\t\tlogger.log({description: 'JS was loaded into document.', element: js, func: 'loadCss', obj: 'dom'});\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\twindow.setTimeout(resolve, 2);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t};\n\n\tclass Google {\n\t\tconstructor(app) {\n\t\t\tthis.app = app ? app : null;\n\t\t\tdomUtil.asyncLoadJs('https://s3.amazonaws.com/kyper-cdn/js/hello.js');\n\t\t}\n\t\tget loadHello() {\n\t\t\treturn domUtil.asyncLoadJs('https://s3.amazonaws.com/kyper-cdn/js/hello.js');\n\t\t}\n\t\tget initHello() {\n\t\t\treturn this.loadHello.then(() => {\n\t\t\t\t//TODO: Load client id from tessellate\n\t\t\t\twindow.hello.init({\n\t\t\t\t\tgoogle: '582741153619-9b3vifnmv2a32v49l63got889tgmnrhs.apps.googleusercontent.com'\n\t\t\t\t}, {redirect_uri: 'redirect.html'});\n\t\t\t\t//Login Listener\n\t\t\t\twindow.hello.on('auth.login', (auth) => {\n\t\t\t\t\tlogger.info({description: 'User logged in to google.', func: 'loadHello', obj: 'Google'});\n\t\t\t\t\t\t// Call user information, for the given network\n\t\t\t\t\t\twindow.hello(auth.network).api('/me').then(function(r) {\n\t\t\t\t\t\t\t// Inject it into the container\n\t\t\t\t\t\t\t//TODO:Send account informaiton to server\n\t\t\t\t\t\t\tvar userData = r;\n\t\t\t\t\t\t\tuserData.provider = auth.network;\n\t\t\t\t\t\t\t//Login or Signup endpoint\n\t\t\t\t\t\t\treturn request.post(this.endpoint + '/provider', userData)\n\t\t\t\t\t\t\t\t.then((response) => {\n\t\t\t\t\t\t\t\t\tlogger.log({description: 'Provider request successful.',  response: response, func: 'signup', obj: 'GoogleUtil'});\n\t\t\t\t\t\t\t\t\treturn response;\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t['catch']((errRes) => {\n\t\t\t\t\t\t\t\t\tlogger.error({description: 'Error requesting login.', error: errRes, func: 'signup', obj: 'Matter'});\n\t\t\t\t\t\t\t\t\treturn Promise.reject(errRes);\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\treturn Promise.resolve();\n\t\t\t});\n\t\t}\n\t\tsignup() {\n\t\t\t//Initalize Hello\n\t\t\tthis.initHello.then(() => {\n\t\t\t\tif (window) {\n\t\t\t\t\twindow.hello.login('google');\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t}\n\n\t// Use a button to handle authentication the first time.\n\n\tclass Matter {\n\t\t/* Constructor\n\t\t * @param {string} appName Name of application\n\t\t */\n\t\tconstructor(appName, opts) {\n\t\t\tif (!appName) {\n\t\t\t\tlogger.error({description: 'Application name requires to use Matter.', func: 'constructor', obj: 'Matter'});\n\t\t\t\tthrow new Error('Application name is required to use Matter');\n\t\t\t} else {\n\t\t\t\tthis.name = appName;\n\t\t\t}\n\t\t\tif (opts) {\n\t\t\t\tthis.options = opts;\n\t\t\t}\n\t\t}\n\t\t/* Endpoint getter\n\t\t *\n\t\t */\n\t\tget endpoint() {\n\t\t\tlet serverUrl = config.serverUrl;\n\t\t\tif (_.has(this, 'options') && this.options.localServer) {\n\t\t\t\tserverUrl = 'http://localhost:4000';\n\t\t\t\tlogger.info({description: 'LocalServer option was set to true. Now server url is local server.', url: serverUrl, func: 'endpoint', obj: 'Matter'});\n\t\t\t}\n\t\t\tif (this.name == 'tessellate') {\n\t\t\t\t//Remove url if host is server\n\t\t\t\tif (window && _.has(window, 'location') && window.location.host == serverUrl) {\n\t\t\t\t\tserverUrl = '';\n\t\t\t\t\tlogger.info({description: 'Host is Server, serverUrl simplified!', url: serverUrl, func: 'endpoint', obj: 'Matter'});\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tserverUrl = config.serverUrl + '/apps/' + this.name;\n\t\t\t\tlogger.info({description: 'Server url set.', url: serverUrl, func: 'endpoint', obj: 'Matter'});\n\t\t\t}\n\t\t\treturn serverUrl;\n\t\t}\n\t\t/* Signup\n\t\t *\n\t\t */\n\t\tsignup(signupData) {\n\t\t\tif (_.isObject(signupData)) {\n\t\t\t\treturn request.post(this.endpoint + '/signup', signupData)\n\t\t\t\t.then((response) => {\n\t\t\t\t\tlogger.log({description: 'Account request successful.', signupData: signupData, response: response, func: 'signup', obj: 'Matter'});\n\t\t\t\t\tif (_.has(response, 'account')) {\n\t\t\t\t\t\treturn response.account;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tlogger.warn({description: 'Account was not contained in signup response.', signupData: signupData, response: response, func: 'signup', obj: 'Matter'});\n\t\t\t\t\t\treturn response;\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t['catch']((errRes) => {\n\t\t\t\t\tlogger.error({description: 'Error requesting signup.', signupData: signupData, error: errRes, func: 'signup', obj: 'Matter'});\n\t\t\t\t\treturn Promise.reject(errRes);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\t//Handle 3rd Party signups\n\t\t\t\tnew Google().signup().then((res) => {\n\t\t\t\t\tlogger.warn('Signup successful:', res);\n\t\t\t\t});\n\t\t\t}\n\n\t\t}\n\t\t/** Login\n\t\t *\n\t\t */\n\t\tlogin(loginData) {\n\t\t\tif (!loginData || !loginData.password || !loginData.username) {\n\t\t\t\tlogger.error({description: 'Username/Email and Password are required to login', func: 'login', obj: 'Matter'});\n\t\t\t\treturn Promise.reject({message: 'Username/Email and Password are required to login'});\n\t\t\t}\n\t\t\treturn request.put(this.endpoint + '/login', loginData)\n\t\t\t.then((response) => {\n\t\t\t\tif (_.has(response, 'data') && _.has(response.data, 'status') && response.data.status == 409) {\n\t\t\t\t\tlogger.warn({description: 'Account not found.', response: response, func: 'login', obj: 'Matter'});\n\t\t\t\t\treturn Promise.reject(response.data);\n\t\t\t\t} else {\n\t\t\t\t\tlogger.log({description: 'Successful login.', response: response, func: 'login', obj: 'Matter'});\n\t\t\t\t\tif (_.has(response, 'token')) {\n\t\t\t\t\t\tthis.token.string = response.token;\n\t\t\t\t\t}\n\t\t\t\t\tif (_.has(response, 'account')) {\n\t\t\t\t\t\tthis.storage.setItem(config.tokenUserDataName, response.account);\n\t\t\t\t\t}\n\t\t\t\t\treturn response.account;\n\t\t\t\t}\n\t\t\t})['catch']((errRes) => {\n\t\t\t\tlogger.error({description: 'Error requesting login.', error: errRes, status: errRes.status,  func: 'login', obj: 'Matter'});\n\t\t\t\tif (errRes.status == 409 || errRes.status == 400) {\n\t\t\t\t\terrRes = errRes.response.text;\n\t\t\t\t}\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t\t/** Logout\n\t\t */\n\t\tlogout() {\n\t\t\treturn request.put(this.endpoint + '/logout').then((response) => {\n\t\t\t\tlogger.log({description: 'Logout successful.', response: response, func: 'logout', obj: 'Matter'});\n\t\t\t\tthis.currentUser = null;\n\t\t\t\tthis.token.delete();\n\t\t\t\treturn response;\n\t\t\t})['catch']((errRes) => {\n\t\t\t\tlogger.error({description: 'Error requesting log out: ', error: errRes, func: 'logout', obj: 'Matter'});\n\t\t\t\tthis.storage.removeItem(config.tokenUserDataName);\n\t\t\t\tthis.token.delete();\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t\tgetCurrentUser() {\n\t\t\tif (this.storage.item(config.tokenUserDataName)) {\n\t\t\t\treturn Promise.resove(this.storage.getItem(config.tokenUserDataName));\n\t\t\t} else {\n\t\t\t\tif (this.isLoggedIn) {\n\t\t\t\t\treturn request.get(this.endpoint + '/user').then((response) => {\n\t\t\t\t\t\t//TODO: Save user information locally\n\t\t\t\t\t\tlogger.log({description: 'Current User Request responded.', responseData: response, func: 'currentUser', obj: 'Matter'});\n\t\t\t\t\t\tthis.currentUser = response;\n\t\t\t\t\t\treturn response;\n\t\t\t\t\t})['catch']((errRes) => {\n\t\t\t\t\t\tif (err.status == 401) {\n\t\t\t\t\t\t\tlogger.warn({description: 'Called for current user without token.', error: errRes, func: 'currentUser', obj: 'Matter'});\n\t\t\t\t\t\t\treturn Promise.resolve(null);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tlogger.error({description: 'Error requesting current user.', error: errRes, func: 'currentUser', obj: 'Matter'});\n\t\t\t\t\t\t\treturn Promise.reject(errRes);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\treturn Promise.resolve(null);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t/* Signup with google\n\t\t *\n\t\t */\n\t\tgoogleSignup() {\n\t\t\treturn new Google().signup();\n\t\t}\n\t\tset currentUser(userData) {\n\t\t\tlogger.log({description: 'Current User set.', user: userData, func: 'currentUser', obj: 'Matter'});\n\t\t\tthis.storage.setItem(config.tokenUserDataName, userData);\n\t\t}\n\t\tget currentUser() {\n\t\t\tif (this.storage.getItem(config.tokenUserDataName)) {\n\t\t\t\treturn this.storage.getItem(config.tokenUserDataName);\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t\t/** updateProfile\n\t\t */\n\t\tupdateProfile(updateData) {\n\t\t\tif (!this.isLoggedIn) {\n\t\t\t\tlogger.error({description: 'No current user profile to update.', func: 'updateProfile', obj: 'Matter'});\n\t\t\t\treturn Promise.reject({message: 'Must be logged in to update profile.'});\n\t\t\t}\n\t\t\t//Send update request\n\t\t\tlogger.warn({description: 'Calling update endpoint.', endpoint: `${this.endpoint}/user/${this.token.data.username}` , func: 'updateProfile', obj: 'Matter'});\n\t\t\treturn request.put(`${this.endpoint}/user/${this.token.data.username}` , updateData).then((response) => {\n\t\t\t\tlogger.log({description: 'Update profile request responded.', responseData: response, func: 'updateProfile', obj: 'Matter'});\n\t\t\t\tthis.currentUser = response;\n\t\t\t\treturn response;\n\t\t\t})['catch']((errRes) => {\n\t\t\t\tlogger.error({description: 'Error requesting current user.', error: errRes, func: 'updateProfile', obj: 'Matter'});\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t\t/** updateProfile\n\t\t */\n\t\tget storage() {\n\t\t\treturn storage;\n\t\t}\n\t\t/** updateProfile\n\t\t */\n\t\tget token() {\n\t\t\treturn token;\n\t\t}\n\t\tget utils() {\n\t\t\treturn {logger: logger, request: request, storage: storage};\n\t\t}\n\t\tget isLoggedIn() {\n\t\t\treturn this.token.string ? true : false;\n\t\t}\n\t\t//Check that user is in a single group or in all of a list of groups\n\t\tisInGroup(checkGroups) {\n\t\t\tif (!this.isLoggedIn) {\n\t\t\t\tlogger.log({description: 'No logged in user to check.', func: 'isInGroup', obj: 'Matter'});\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t//Check if user is\n\t\t\tif (checkGroups && _.isString(checkGroups)) {\n\t\t\t\tlet groupName = checkGroups;\n\t\t\t\t//Single role or string list of roles\n\t\t\t\tlet groupsArray = groupName.split(',');\n\t\t\t\tif (groupsArray.length > 1) {\n\t\t\t\t\t//String list of groupts\n\t\t\t\t\tlogger.info({description: 'String list of groups.', list: groupsArray, func: 'isInGroup', obj: 'Matter'});\n\t\t\t\t\treturn this.isInGroups(groupsArray);\n\t\t\t\t} else {\n\t\t\t\t\t//Single group\n\t\t\t\t\tlet groups = this.token.data.groups || [];\n\t\t\t\t\tlogger.log({description: 'Checking if user is in group.', group: groupName, userGroups: this.token.data.groups || [],  func: 'isInGroup', obj: 'Matter'});\n\t\t\t\t\treturn _.any(groups, (group) =>  {\n\t\t\t\t\t\treturn groupName == group.name;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t} else if (checkGroups && _.isArray(checkGroups)) {\n\t\t\t\t//Array of roles\n\t\t\t\t//Check that user is in every group\n\t\t\t\tlogger.info({description: 'Array of groups.', list: checkGroups, func: 'isInGroup', obj: 'Matter'});\n\t\t\t\treturn this.isInGroups(checkGroups);\n\t\t\t} else {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t//TODO: Handle string and array inputs\n\t\t}\n\t\tisInGroups(checkGroups) {\n\t\t\t//Check if user is in any of the provided groups\n\t\t\tif (checkGroups && _.isArray(checkGroups)) {\n\t\t\t\treturn _.map(checkGroups, (group) =>  {\n\t\t\t\t\tif (_.isString(group)) {\n\t\t\t\t\t\t//Group is string\n\t\t\t\t\t\treturn this.isInGroup(group);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t//Group is object\n\t\t\t\t\t\treturn this.isInGroup(group.name);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else if (checkGroups && _.isString(checkGroups)) {\n\t\t\t\t//TODO: Handle spaces within string list\n\t\t\t\tlet groupsArray = checkGroups.split(',');\n\t\t\t\tif (groupsArray.length > 1) {\n\t\t\t\t\treturn this.isInGroups(groupsArray);\n\t\t\t\t}\n\t\t\t\treturn this.isInGroup(groupsArray[0]);\n\t\t\t} else {\n\t\t\t\tlogger.error({description: 'Invalid groups list.', func: 'isInGroups', obj: 'Matter'});\n\t\t\t}\n\t\t}\n\t};\n\n\treturn Matter;\n\n}));"],"sourceRoot":"/source/"}